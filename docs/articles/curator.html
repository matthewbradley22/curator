<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="curator">
<title>Introduction to curator • curator</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to curator">
<meta property="og:description" content="curator">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">curator</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/curator.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/matthewbradley22/curator/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Introduction to curator</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/matthewbradley22/curator/blob/HEAD/vignettes/curator.Rmd" class="external-link"><code>vignettes/curator.Rmd</code></a></small>
      <div class="d-none name"><code>curator.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/matthewbradley22/curator" class="external-link">curator</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="overview">Overview:<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>curatoR was designed to help biologists pull data from GBIF and
curate it quickly. GBIF data is messy, and manually curating it is time
consuming. curatoR allows biologists to use an existing Expert Curated
Dataset (ECD) to filter GBIF data and easily update the ECD.</p>
</div>
<div class="section level2">
<h2 id="workflow">Workflow<a class="anchor" aria-label="anchor" href="#workflow"></a>
</h2>
<div class="section level3">
<h3 id="retrieving-data">Retrieving data:<a class="anchor" aria-label="anchor" href="#retrieving-data"></a>
</h3>
<p>The first step of the workflow is done using the “occ_since” function
which allows a user to pull GBIF data of a certain taxon since a certain
date. This function defaults to pulling all Carex data since June 2021.
Note that the function defaults to pulling all data (up to 1,000,000
occurrences) since the date, and this step can be quite slow.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">=</span> <span class="fu"><a href="../reference/occ_since.html">occ_since</a></span><span class="op">(</span>numObs <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 148</span></span></span>
<span><span class="co">#&gt;   key     scien…¹ decim…² decim…³ issues datas…⁴ publi…⁵ insta…⁶ publi…⁷ proto…⁸</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 342857… Carex …    55.9    8.42 cdrou… 963a6b… 1a4e61… f9c0c4… DK      DWC_AR…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 342857… Carex …    55.9    8.42 cdrou… 963a6b… 1a4e61… f9c0c4… DK      DWC_AR…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 343704… Carex …    55.9    8.42 cdrou… 963a6b… 1a4e61… f9c0c4… DK      DWC_AR…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 343711… Carex …    56.1    9.57 cdrou… 67fabc… 1a4e61… f9c0c4… DK      DWC_AR…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 343711… Carex …    55.6    9.27 cdrou… 67fabc… 1a4e61… f9c0c4… DK      DWC_AR…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 343713… Carex …    55.2   11.8  cdrou… 67fabc… 1a4e61… f9c0c4… DK      DWC_AR…</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 138 more variables: lastCrawled &lt;chr&gt;, lastParsed &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   crawlId &lt;int&gt;, hostingOrganizationKey &lt;chr&gt;, basisOfRecord &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   occurrenceStatus &lt;chr&gt;, taxonKey &lt;int&gt;, kingdomKey &lt;int&gt;, phylumKey &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   classKey &lt;int&gt;, orderKey &lt;int&gt;, familyKey &lt;int&gt;, genusKey &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   speciesKey &lt;int&gt;, acceptedTaxonKey &lt;int&gt;, acceptedScientificName &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   kingdom &lt;chr&gt;, phylum &lt;chr&gt;, order &lt;chr&gt;, family &lt;chr&gt;, genus &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   species &lt;chr&gt;, genericName &lt;chr&gt;, specificEpithet &lt;chr&gt;, taxonRank &lt;chr&gt;, …</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ Use `colnames()` to see all variable names</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="load-ecd">Load ECD:<a class="anchor" aria-label="anchor" href="#load-ecd"></a>
</h3>
<p>The user should load an ECD dataset into R. For this example I will
use an example ECD that comes with curatoR and contains 50,000 Carex
observations</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ECD</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ECD</span><span class="op">)</span></span>
<span><span class="co">#&gt;                  species decimalLongitude decimalLatitude CountryCode</span></span>
<span><span class="co">#&gt; 97981       Carex flacca        -0.469800       38.747500         ESP</span></span>
<span><span class="co">#&gt; 273977    Carex vaginata        20.934800       69.911500         NOR</span></span>
<span><span class="co">#&gt; 37262      Carex brownii       140.834010       41.398240         JPN</span></span>
<span><span class="co">#&gt; 167628    Carex maritima        14.223502       67.162739         NOR</span></span>
<span><span class="co">#&gt; 157371      Carex livida         7.968265       59.402211         NOR</span></span>
<span><span class="co">#&gt; 285616 Carex neblinensis       -65.980049        0.835215         VEN</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="initial-flags">Initial Flags:<a class="anchor" aria-label="anchor" href="#initial-flags"></a>
</h3>
<p>The first step of cleaning data uses a function that wraps the
CoordinateCleaner:clean_coordinates function and creates an object with
the original dataframe, as well as new columns that indicate flags. This
object will be used for the rest of the workflow.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">flagged</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/flag_data.html">flag_data</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span><span class="co">#&gt; OGR data source with driver: ESRI Shapefile </span></span>
<span><span class="co">#&gt; Source: "/private/var/folders/w3/nt2mw8xj72z9mmctnpprhvs80000gn/T/RtmpUrMLv3", layer: "ne_50m_land"</span></span>
<span><span class="co">#&gt; with 1420 features</span></span>
<span><span class="co">#&gt; It has 3 fields</span></span>
<span><span class="co">#&gt; Integer64 fields read as strings:  scalerank</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">flagged</span><span class="op">)</span></span>
<span><span class="co">#&gt;     .val     .equ     .zer     .cap     .cen     .sea     .otl     .gbf </span></span>
<span><span class="co">#&gt;        0        0        0       14        0       54       30        0 </span></span>
<span><span class="co">#&gt;    .inst .summary </span></span>
<span><span class="co">#&gt;        0       91</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="label-continents">Label continents:<a class="anchor" aria-label="anchor" href="#label-continents"></a>
</h3>
<p>In the coming flagging functions, it will be necessary to have the
continents labeled for each occurrence. Our ECD has a country code
column that is named differently than the default, so I specify the name
of the column.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">flagged</span><span class="op">$</span><span class="va">continent</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_continents.html">get_continents</a></span><span class="op">(</span><span class="va">flagged</span><span class="op">)</span></span>
<span><span class="va">ECD</span><span class="op">$</span><span class="va">continent</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_continents.html">get_continents</a></span><span class="op">(</span><span class="va">ECD</span>, country <span class="op">=</span> <span class="st">"CountryCode"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in countrycode_convert(sourcevar = sourcevar, origin = origin, destination = dest, : Some values were not matched unambiguously: , AGE, AGS, AGW, ATF, BZC, BZE, BZL, BZS, CLC, CLM, CLN, CLS, COS, GUA, HON, JNF, LES, MXC, MXE, PAR, PER , PHI, PT-AZO, TAN, URU, ZIM, ZZ</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">flagged</span><span class="op">$</span><span class="va">continent</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Europe" "Europe" "Europe" "Europe" "Europe" "Europe"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="flagging-countries">Flagging Countries:<a class="anchor" aria-label="anchor" href="#flagging-countries"></a>
</h3>
<p>The next step is to flag any occurrences in which the species is in a
country in which it does not occur in the ECD. For each of these new
flagging steps the user can pass the whole “Flagged” object from above,
and can indicate any column names if they differ from the expected
names.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Can see new .country column in the summary of flagged.</span></span>
<span><span class="va">flagged</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/flag_countries.html">flag_countries</a></span><span class="op">(</span><span class="va">flagged</span>, <span class="va">ECD</span>, ECDcountry <span class="op">=</span> <span class="st">"CountryCode"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">flagged</span><span class="op">)</span></span>
<span><span class="co">#&gt;     .val     .equ     .zer     .cap     .cen     .sea     .otl     .gbf </span></span>
<span><span class="co">#&gt;        0        0        0       14        0       54       30        0 </span></span>
<span><span class="co">#&gt;    .inst .summary .country </span></span>
<span><span class="co">#&gt;        0      176       88</span></span>
<span></span>
<span><span class="co">#We can see which species-nations combiantions are causing these flags</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">flagged</span><span class="op">[</span><span class="va">flagged</span><span class="op">$</span><span class="va">.country</span> <span class="op">==</span> <span class="cn">F</span>,<span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"species"</span>, <span class="st">"countryCode"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;                 species countryCode</span></span>
<span><span class="co">#&gt; 77         Carex pilosa         UKR</span></span>
<span><span class="co">#&gt; 91   Carex fascicularis         AUS</span></span>
<span><span class="co">#&gt; 135      Carex erinacea         CHL</span></span>
<span><span class="co">#&gt; 215      Carex arenaria         GBR</span></span>
<span><span class="co">#&gt; 250    Carex halleriana         PRT</span></span>
<span><span class="co">#&gt; 302       Carex panicea         NLD</span></span>
<span><span class="co">#&gt; 373      Carex strigosa         NLD</span></span>
<span><span class="co">#&gt; 521  Carex brongniartii         ARG</span></span>
<span><span class="co">#&gt; 527 Carex aematorhyncha         ARG</span></span>
<span><span class="co">#&gt; 555      Carex morrowii         SWE</span></span>
<span><span class="co">#&gt; 584        Carex remota         CHE</span></span>
<span><span class="co">#&gt; 585       Carex pendula         CHE</span></span>
<span><span class="co">#&gt; 588   Carex acutiformis         CHE</span></span>
<span><span class="co">#&gt; 589         Carex hirta         CHE</span></span>
<span><span class="co">#&gt; 591      Carex digitata         CHE</span></span>
<span><span class="co">#&gt; 592        Carex flacca         CHE</span></span>
<span><span class="co">#&gt; 594     Carex sylvatica         CHE</span></span>
<span><span class="co">#&gt; 608      Carex muricata         CHE</span></span>
<span><span class="co">#&gt; 617  Carex sempervirens         CHE</span></span>
<span><span class="co">#&gt; 621          Carex alba         CHE</span></span>
<span><span class="co">#&gt; 639       Carex montana         CHE</span></span>
<span><span class="co">#&gt; 642       Carex humilis         CHE</span></span>
<span><span class="co">#&gt; 676    Carex halleriana         FRA</span></span>
<span><span class="co">#&gt; 882    Carex parviflora         DNK</span></span>
<span><span class="co">#&gt; 968       Carex leersii         USA</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="flagging-convex-hulls">Flagging Convex Hulls:<a class="anchor" aria-label="anchor" href="#flagging-convex-hulls"></a>
</h3>
<p>Next, for each species-continent combination, we can build a convex
hull (a species on 3 different continents will have 3 separate convex
hulls) and flag species that occur outside of these convex hulls.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">flagged</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/flag_convex_hull.html">flag_convex_hull</a></span><span class="op">(</span><span class="va">flagged</span>, <span class="va">ECD</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">flagged</span><span class="op">)</span></span>
<span><span class="co">#&gt;     .val     .equ     .zer     .cap     .cen     .sea     .otl     .gbf </span></span>
<span><span class="co">#&gt;        0        0        0       14        0       54       30        0 </span></span>
<span><span class="co">#&gt;    .inst .summary .country    .hull </span></span>
<span><span class="co">#&gt;        0      256       88      102</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="flagging-based-on-distance">Flagging based on distance<a class="anchor" aria-label="anchor" href="#flagging-based-on-distance"></a>
</h3>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Matthew Bradley.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
